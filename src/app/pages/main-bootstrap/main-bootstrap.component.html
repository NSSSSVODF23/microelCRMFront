<div class="top-panel">
    <img [style.height]="'3rem'" src="assets/logo-dark.svg" alt="">
    <app-button *ngIf="!isTaskCreationPage" label="Создать задачу" icon="add_task" model="p-button-success" (onClick)="openCreateTaskPage()"></app-button>
    <div class="stretched"></div>
    <app-my-active-chats></app-my-active-chats>
    <app-account-panel></app-account-panel>
</div>
<router-outlet></router-outlet>

<app-notifications-popup-panel></app-notifications-popup-panel>

<p-sidebar appScrollToBottomEmitter [showCloseIcon]="false" [blockScroll]="true" [(visible)]="notifyService.displaySideBar"
           [position]="'right'" (onShow)="notifyService.load()" (onHide)="notifyService.readAllNotifications()"
           [style]="{width:'max-content', maxWidth: '30vw'}">
    <ng-template pTemplate="header">
        <span class="caption-header flexed inline hcenter gap3"><i class="mdi-circle_notifications"></i> Уведомления</span>
        <div class="stretched"></div>
        <p-button styleClass="p-button-text" icon="mdi-clear_all" label="Отчистить"
                  [disabled]="!notifyService.isHasUnread" (onClick)="notifyService.readAllNotifications()"></p-button>
    </ng-template>
    <ng-template pTemplate="content">
        <div class="list-view flexed v-scroll" appScrollToBottomEmitter *ngIf="!notifyService.isEmpty" (onScrollToBottom)="!notifyService.isLast && notifyService.load()">
            <app-notification-item [notification]="notify" *ngFor="let notify of notifyService.list"></app-notification-item>
        </div>
        <div class="flexed hcenter vcenter column p10" [style.padding-top]="'10rem'" *ngIf="notifyService.isEmpty">
            <span class="flexed hcenter gap5 caption-common-message"><i class="mdi-inventory"></i> Новых уведомлений пока нет</span>
            <p-button label="Показать предыдущие" styleClass="p-button-text one-line" (onClick)="notifyService.changeNotificationViewMode('ALL')"></p-button>
        </div>
    </ng-template>
</p-sidebar>

<p-confirmDialog></p-confirmDialog>
<app-media-viewer></app-media-viewer>
<app-chat-panel #chatPanelEl></app-chat-panel>
