<div appExtendPageHeight class="flexed column vcenter gap20">
    <ng-container [ngSwitch]="loadingState">
        <ng-container *ngSwitchCase="'LOADING'">
            <p-progressSpinner strokeWidth="1" class="custom-spinner custom-spinner-8xl custom-spinner-primary center-of-page"></p-progressSpinner>
        </ng-container>
        <ng-container *ngSwitchCase="'ERROR'">
            <div class="panel flexed column hcenter vcenter gap15 p20 caption size-big wt-bold f-color-danger responsive-wrapper">
                <div class="flexed column hcenter">
                    <span class="mds-error"></span>
                    <span>
                        Задачи #{{taskId}} не существует
                    </span>
                </div>
                <p-button label="Перейти назад" icon="mdi-chevron_left" (onClick)="customNav.backOrDefault(['/tasks','list'])" styleClass="p-button-outlined"></p-button>
            </div>
        </ng-container>
        <ng-container *ngSwitchCase="'READY'">
            <div class="responsive-wrapper stretched flexed gap10 column">
                <p-menubar [model]="managementMenu" [style]="{border: 'none'}" styleClass="panel">
                    <ng-template pTemplate="start">
                        <div class="flexed gap10 p5 indent1 hcenter">
                            <p-button (onClick)="customNav.backOrDefault(['/tasks','list'])" icon="mdi-chevron_left"
                                      pTooltip="Назад" styleClass="p-button-icon p-button-text"
                                      tooltipPosition="bottom"></p-button>
                            <div class="flexed column ">
                                <span class="header400">{{currentTask?.modelWireframe?.name ?? ''}}</span>
                                <div class="flexed bline gap5 caption size-small f-color-500">
                                    <span>Стадия:</span>
                                    <app-tiny-button (onClick)="stageMenu.toggle($event)"
                                                     [disabled]="!currentTask?.currentStage || currentTask?.taskStatus === 'CLOSE'"
                                                     [label]="currentTask?.currentStage?.label ?? 'не установлена'"
                                                     [size]=".9"
                                                     pTooltip="Изменить" tooltipPosition="bottom"></app-tiny-button>
                                    <span (click)="moveToNextStage()" *ngIf="!isLastStage() && currentTask?.currentStage"
                                          class="next-stage-button">
                                Следующая <i class="mdi-chevron_right"></i>
                            </span>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="end">
                        <ng-container *ngIf="currentTask?.actualTo || (currentTask?.actualFrom && (isBeforeActualFrom$|async))">
                            <ng-container
                                    *ngIf="isBeforeActualFrom$|async; then actualFromLabel else actualToLabel"></ng-container>
                        </ng-container>
                    </ng-template>
                </p-menubar>
                <div class="grided gap10 spbtw" [style]="{grid: '1fr/1fr max-content'}">
                    <div class="flexed gap7 column panel p15 stretched h-min">
                        <div class="input-label-wrapper w max-fit">
                            <label>Теги</label>
                            <app-task-tag-selector [formControl]="installedTags"></app-task-tag-selector>
                        </div>
                        <div *ngFor="let field of currentTask?.fields ?? []" class="flexed gap1 column">
                            <div class="caption size-small wt-bold f-color-500">{{field.name}}</div>
                            <div class="caption">
                                <ng-container [ngSwitch]="field.wireframeFieldType">
                                    <a *ngSwitchCase="'LOGIN'" [href]="'clients/billing/user/'+field.textRepresentation">{{field.textRepresentation}}</a>
                                    <app-dial-buttons-list *ngSwitchCase="'PHONE_ARRAY'" [phoneData]="field.phoneData"></app-dial-buttons-list>
                                    <span *ngSwitchDefault>
                                        {{field.textRepresentation}}
                                    </span>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                    <div class="task-control-panel panel p15 h-min">
                        <div class="task-control-panel-item">
                            <i class="mdi-flag"></i>
                            <span class="task-control-panel-item-name">
                                Статус
                            </span>
                            <span [class]="'task-control-panel-item-value status ' + currentTask?.taskStatus ">
                                {{currentTask | taskStatus}}
                            </span>
                        </div>
                        <div class="task-control-panel-item">
                            <i class="mdi-person"></i>
                            <span class="task-control-panel-item-name">
                                Автор
                            </span>
                            <span class="task-control-panel-item-value">
                                <app-employee-label [employee]="currentTask?.creator"></app-employee-label>
                            </span>
                        </div>
                        <div class="task-control-panel-item">
                            <i class="mdi-event"></i>
                            <span class="task-control-panel-item-name">
                                Создана
                            </span>
                            <span class="task-control-panel-item-value">
                                {{currentTask?.created | date:'dd MMM yyyy HH:mm' | titlecase}}
                            </span>
                        </div>
                        <div *ngIf="currentTask?.responsible" class="task-control-panel-item">
                            <i class="mdi-person"></i>
                            <span class="task-control-panel-item-name">
                            Ответственный
                        </span>
                            <span class="task-control-panel-item-value">
                            <app-employee-label [employee]="currentTask?.responsible"></app-employee-label>
                        </span>
                        </div>
                        <div *ngIf="activeWorkLog" class="dedicated-panel">
                            <div class="title">
                                <i class="mdi-groups"></i>
                                <span class="caption">
                                Назначены монтажники
                            </span>
                            </div>
                            <div class="list">
                                <app-employee-label *ngFor="let employee of activeWorkLog.employees"
                                                    [employee]="employee"></app-employee-label>
                            </div>
                        </div>
                        <div *ngIf="isTaskHasObservers()" class="dedicated-panel">
                            <div class="title">
                                <i class="mdi-groups"></i>
                                <span class="caption">
                                Наблюдатели
                            </span>
                            </div>
                            <div class="list">
                                <div *ngFor="let department of currentTask?.departmentsObservers"
                                     class="flexed hcenter gap5">
                                    <app-department-label [department]="department"></app-department-label>
                                </div>
                                <span *ngFor="let employee of currentTask?.employeesObservers" class="flexed hcenter gap5">
                                <app-employee-label [employee]="employee"></app-employee-label>
                            </span>
                            </div>
                        </div>
                        <div *ngIf="isTaskHasParent() || isTaskHasChilds()" class="dedicated-panel">
                            <div class="title">
                                <i class="mdi-account_tree"></i>
                                <span class="caption">
                                Связанные задачи
                            </span>
                                <app-tiny-button (onClick)="openTaskChainDialog()" icon="account_tree"
                                                 pTooltip="Показать схему"
                                                 tooltipPosition="bottom"></app-tiny-button>
                            </div>
                            <div class="list">
                                <div *ngIf="isTaskHasParent()" class="flexed hcenter gap3">
                                    <span class="caption size-small f-color-500">Родительская:</span>
                                    <app-task-link [taskId]="currentTask?.parent ?? 0"></app-task-link>
                                    <app-tiny-button (onClick)="unlinkParentTask()"
                                                     *ngIf="!!currentTask?.parent"
                                                     icon="link_off"
                                                     model="danger"
                                                     pTooltip="Отсоединить задачу"
                                                     tooltipPosition="bottom"></app-tiny-button>
                                </div>
                                <div *ngIf="isTaskHasChilds()" class="flexed gap5 caption size-small f-color-500">
                                    <span>Дочерние:</span>
                                    <div class="flexed column gap3">
                                    <span *ngFor="let taskCld of currentTask?.children" class="flexed gap3 hcenter">
                                        <app-task-link [task]="taskCld"></app-task-link>
                                        <app-tiny-button (onClick)="unlinkParentTask(taskCld.taskId)" icon="link_off"
                                                         model="danger" pTooltip="Отсоединить задачу"
                                                         tooltipPosition="bottom"></app-tiny-button>
                                    </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex flex-column p-4 gap-4 shadow-1 border-round-lg bg-white" [hidden]="!journalVisible">
                    <span class="text-bluegray-400 text-3xl font-semibold flex gap-3 align-items-center">
                        <span>
                            Комментарии
                        </span>
                        <p-dropdown [options]="taskJournalSortingOptions" [(ngModel)]="taskJournalSorting"></p-dropdown>
                        <p-toggleButton onLabel="Cобытия" offLabel="Cобытия"
                                        onIcon="mdi-visibility" offIcon="mdi-visibility_off" [(ngModel)]="taskEventsVisible"></p-toggleButton>
                    </span>
                    <app-task-journal (editCommentChange)="editCommentChanged($event)" (onFirstLoad)="journalVisible = $event" [(editComment)]="editComment"
                                      [(replyComment)]="replyComment" [taskId]="taskId" [showEvents]="taskEventsVisible" [sortingType]="taskJournalSorting"
                                      class="indent1"></app-task-journal>
                </div>
            </div>
            <div [formGroup]="commentInputForm" *ngIf="!isTaskClose()" class="sticky bottom1 flexed vcenter column gap10">
                <div *ngIf="replyComment" [style.padding]="'1rem 1.5rem'"
                     class="flexed hcenter gap15 panel responsive-wrapper caption size-small wt-bold f-color-primary">
                    <i class="mdi-reply"></i>
                    <div class="flexed column">
                        <app-employee-label [employee]="replyComment.creator" [size]="2"></app-employee-label>
                        <div class="caption indent2">
                            {{replyComment.simpleText}}
                        </div>
                    </div>
                    <div class="stretched">
                    </div>
                    <p-button (onClick)="replyComment = undefined" [disabled]="commentInputForm.disabled"
                              icon="mdi-cancel" styleClass="p-button-icon p-button-text"></p-button>
                </div>
                <div *ngIf="editComment" [style.padding]="'1rem 1.5rem'"
                     class="flexed hcenter gap15 panel responsive-wrapper caption size-small wt-bold f-color-primary">
                    <i class="mdi-edit"></i>
                    <div class="flexed column gap3">
                        <span>Редактирование</span>
                        <div class="caption">
                            {{editComment.simpleText}}
                        </div>
                    </div>
                    <div class="stretched">
                    </div>
                    <p-button (onClick)="editComment = undefined; commentInputForm.reset({text: '', files: []})" [disabled]="commentInputForm.disabled" icon="mdi-cancel"
                              styleClass="p-button-icon p-button-text"></p-button>
                </div>
                <ng-container [ngSwitch]="commentEditorMode" *ngIf="!isTaskClose()">
                    <ng-container *ngSwitchCase="'simple'">
                        <div @fadeIn [style.padding]="'.5rem 1rem'" class="flexed hcenter gap5 panel responsive-wrapper">
                            <p-button [disabled]="commentInputForm.disabled" icon="mdi-text_fields"
                                      pTooltip="Расширенный редактор" (onClick)="commentEditorMode = 'extended'"
                                      styleClass="p-button-icon p-button-text"></p-button>
                            <textarea (keydown)="sendCommentByEnter($event)" [disabled]="isTaskClose()" (paste)="pasteFiles($event)" appTextareaAutoresize class="borderless-text-field stretched"
                                      formControlName="text" placeholder="Новый комментарий..."></textarea>
                            <app-file-input #fileInput *ngIf="!editComment" [short]="true" formControlName="files"></app-file-input>
                            <p-button (onClick)="sendComment()" [disabled]="commentInputForm.disabled"
                                      icon="mdi-send" styleClass="p-button-icon p-button-text p-button-rounded"></p-button>
                        </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="'extended'">
                        <div @fadeIn [style.padding]="'1rem 1rem'" class="flexed column gap5 panel responsive-wrapper">
                        <span class="flexed hcenter gap5">
                            <p-button [disabled]="commentInputForm.disabled" icon="mdi-short_text" label="Строка ввода"
                                      pTooltip="Строка ввода" (onClick)="commentEditorMode = 'simple'; clearCommentText()"
                                      styleClass="p-button-icon p-button-text"></p-button>
                            <div class="stretched"></div>
                            <app-file-input #fileInput *ngIf="!editComment" formControlName="files"></app-file-input>
                            <p-button (onClick)="sendComment()" [disabled]="commentInputForm.disabled"
                                      icon="mdi-send" label="Отправить" styleClass=" p-button-text"></p-button>
                        </span>
                            <quill-editor #commentEditor (keydown)="sendCommentByEnter($event)"
                                          (onContentChanged)="empInsertPanel.setQuillEvent($event)"
                                          [modules]="quillModules" [disabled]="isTaskClose()" [formats]="quillFormats"
                                          [styles]="{maxHeight:'30vh', minHeight:'10rem', overflow:'auto'}"
                                          class="input" formControlName="text" (paste)="pasteFiles($event)"
                                          placeholder="Новый комментарий..."></quill-editor>
                        </div>
                    </ng-container>
                </ng-container>
            </div>
        </ng-container>
    </ng-container>
</div>

<app-attachments-history-dialog [(show)]="showFilesHistory" [taskId]="taskId"></app-attachments-history-dialog>

<!--Диалог назначения монтажников-->
<p-dialog (onHide)="clearAppointInstallers()" [(visible)]="showAppointInstallersMenu" [dismissableMask]="true"
          [breakpoints]="{'960px': '75vw', '640px': '100vw'}" [draggable]="false" [modal]="true" [resizable]="false"
          [style]="{width: '50vw'}" header="Назначение монтажников">
    <div class="flexed column gap10">
        <p-pickList [dragdrop]="true" [showSourceControls]="false" [showTargetControls]="false"
                    [sourceStyle]="{height: '40vh', maxHeight: '15rem'}" [source]="sourceInstallers"
                    [targetStyle]="{height:'40vh', maxHeight: '15rem'}"
                    [target]="targetInstallers" sourceHeader="Доступные"
                    targetHeader="Назначенные">
            <ng-template let-installer pTemplate="item">
                <div class="flexed hcenter gap5">
                    <app-employee-label [employee]="installer" [size]="1.9"></app-employee-label>
                </div>
            </ng-template>
        </p-pickList>
        <div [style]="{minHeight: '8rem'}" class="flexed column">
            <div class="caption size-small f-color-500">Текущая цель (необязательно)</div>
            <textarea [(ngModel)]="targetDescription" [autoResize]="true" [rows]="3" class="stretched"
                      pInputTextarea></textarea>
        </div>
        <div class="flexed gap5 vend">
            <app-button (onClick)="resetListAppointedInstallers()"
                        [disabled]="targetInstallers.length === 0 || appointmentRequested"
                        icon="delete" label="Сбросить" model="p-button-text p-button-secondary"></app-button>
            <app-button (onClick)="sendListAppointedInstallers()" [disabled]="targetInstallers.length === 0"
                        [loading]="appointmentRequested"
                        icon="assignment" label="Назначить"></app-button>
        </div>
    </div>
</p-dialog>

<!--Диалог назначения наблюдателей-->
<p-dialog [(visible)]="showChangeObserversDialog" [breakpoints]="{'960px': '75vw', '640px': '100vw'}"
          [draggable]="false" [modal]="true" [resizable]="false" [dismissableMask]="true"
          [style]="{width: '50vw'}" header="Изменить ответственных">
    <p-tabView>
        <p-tabPanel header="Отделы">
            <div [style.max-height]="'50vh'" class="list-view">
                <div *ngFor="let dep of departmentList" class="list-view-item bordered flexed hcenter gap10">
                    <p-checkbox [(ngModel)]="selectedDepartmentObservers" [value]="dep.departmentId"
                                name="dep"></p-checkbox>
                    <span appColorize class="caption">{{dep.name}}</span>
                </div>
            </div>
        </p-tabPanel>
        <p-tabPanel header="Сотрудники">
            <div [style.max-height]="'50vh'" class="list-view">
                <div *ngFor="let emp of employeeList" class="list-view-item bordered flexed hcenter gap10">
                    <p-checkbox [(ngModel)]="selectedEmployeeObservers" [value]="emp.login" name="emp"></p-checkbox>
                    <app-employee-label [employee]="emp" [size]="2.3"></app-employee-label>
                </div>
            </div>
        </p-tabPanel>
    </p-tabView>
    <div class="flexed gap10 hcenter vend">
        <app-button (onClick)="updateObservableList()" icon="cancel" label="Сбросить"
                    model="p-button-text p-button-secondary"></app-button>
        <app-button (onClick)="sendObservableList()" [loading]="changingTaskObservers" icon="assignment"
                    label="Назначить"
                    model="p-button-success"></app-button>
    </div>
</p-dialog>

<!--Диалог назначения ответственного-->
<p-dialog [(visible)]="showChangeResponsibleDialog" [breakpoints]="{'960px': '50vw', '640px': '100vw'}"
          [draggable]="false" [modal]="true" [resizable]="false" [dismissableMask]="true"
          [style]="{width: '35rem', height: '50vh'}" header="Изменить ответственного">
    <div class="flexed column gap10 full-height">
        <div class="list-view stretched p5 gap5">
            <div (click)="selectedEmployeeAsResponsible = emp" *ngFor="let emp of employeeList"
                 [ngClass]="{selected:selectedEmployeeAsResponsible?.login === emp.login}"
                 class="list-view-item hovered bordered flexed hcenter gap10">
                <app-avatar [name]="emp.fullName" [size]="2.3" [src]="emp.avatar"></app-avatar>
                <div class="flexed column">
                    <span class="caption">{{emp.fullName}}</span>
                    <span class="caption size-small wt-bold f-color-500">{{emp.department?.name}}</span>
                </div>
                <span *ngIf="selectedEmployeeAsResponsible?.login === emp.login" class="caption size-small wt-bold f-color-primary">(Выбран)</span>
            </div>
        </div>
        <div class="flexed vend hcenter gap10">
            <app-button (onClick)="changeResponsible()" [disabled]="!selectedEmployeeAsResponsible"
                        [loading]="selectingResponsible" icon="check" label="Изменить"></app-button>
        </div>
    </div>
</p-dialog>

<!--Диалог присвоения задачи-->
<app-task-selecting-dialog #taskLinkingDialog (onMultiplySelected)="linkToChildTasks($event)"
                           (onSelected)="linkToParentTask($event)"
                           [excludedTasks]="excludedTasks" header="Связать задачи"
></app-task-selecting-dialog>

<!--Диалог просмотра цепочки задач-->
<p-dialog [(visible)]="showTaskChainDialog" [breakpoints]="{'960px': '75vw', '640px': '100vw'}"
          [draggable]="false" [maximizable]="true" [modal]="true" [resizable]="false" [dismissableMask]="true"
          [style]="{width: '60vw'}" header="Цепочка задач">
    <div [style]="{overflow:'auto',minHeight:'100%'}" appDragScrolling>
        <p-organizationChart [value]="taskChain">
            <ng-template let-node pTemplate="task">
                <app-task-list-element [item]="node.data"
                                       [style]="{maxWidth:'45rem',minWidth:'35rem'}"></app-task-list-element>
            </ng-template>
        </p-organizationChart>
    </div>
</p-dialog>

<!--Диалог редактирования информации в задаче-->
<p-dialog [(visible)]="isShowEditTaskDialog" [breakpoints]="{'960px': '75vw', '640px': '100vw'}"
          [draggable]="false" [modal]="true" [resizable]="false" [dismissableMask]="true"
          [style]="{width: '50vw', maxHeight: '70vh'}" header="Редактирование информации в задаче">
    <div class="flexed column gap10">
        <div [formGroup]="editTaskForm" class="flexed gap7 column">
            <app-task-template-input *ngFor="let field of taskFields"
                                     [field]="field" [formControlName]="field.modelItemId"
                                     class="stretched"></app-task-template-input>
        </div>
        <div class="stretched"></div>
        <div class="flexed vend hcenter sticky bottom0">
            <app-button (onClick)="doEditTask()" [loading]="editBlocked" icon="save"
                        label="Сохранить" model="p-button-success"></app-button>
        </div>
    </div>
</p-dialog>

<!--Диалог просмотра истории редактирования информации в задаче-->
<p-dialog [(visible)]="isShowEditHistoryDialog" [breakpoints]="{'960px': '85vw', '640px': '100vw'}"
          [draggable]="false" [modal]="true" [resizable]="false" [dismissableMask]="true"
          [style]="{width: '75vw', maxHeight: '70vh'}" header="История редактирования задачи">
    <div class="flexed column gap10">
        <div class="flexed hcenter vcenter gap20 p5">
            <app-button (onClick)="changeCurrentSnapshot(-1)" icon="chevron_left" label="Предыдущий"
                        model="p-button-text"></app-button>
            <div *ngIf="editTaskSnapshots?.length" class="flexed column hcenter vcenter gap5">
                <span class="flexed hcenter gap3">
                    Время:
                    <span class="caption size-small">
                        {{editTaskSnapshots[indexEditSnapshot].whenEdited | date: 'dd MMMM yyyy HH:mm'}}
                    </span>
                </span>
                <span class="flexed hcenter gap6">
                    Редактор:
                    <app-employee-label
                            [employee]="editTaskSnapshots[indexEditSnapshot].whoEdited"></app-employee-label>
                </span>
                <span class="caption size-small">
                    Снимок {{indexEditSnapshot + 1}} из {{editTaskSnapshots.length}}
                </span>
            </div>
            <app-button (onClick)="changeCurrentSnapshot(1)" icon="chevron_right" iconPos="right" label="Следующий"
                        model="p-button-text"></app-button>
        </div>
        <table class="change-comparison-table">
            <thead>
            <tr>
                <th>
                        <span class="one-line">
                            Название поля
                        </span>
                </th>
                <th>
                        <span class="one-line">
                            Значение до
                        </span>
                </th>
                <th>
                </th>
                <th>
                        <span class="one-line">
                            Значение после
                        </span>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let fieldPair of snapshotFieldPairs(editTaskSnapshots[indexEditSnapshot]); trackBy: trackSnapshotPair">
                <td>
                        <span class="caption size-big one-line">
                            {{fieldPair.before.name}}
                        </span>
                </td>
                <td>
                    {{fieldPair.before.textRepresentation}}
                </td>
                <td>
                        <span *ngIf="!areFieldsEqual(fieldPair.before,fieldPair.after)"
                              class="material-icons-round caption size-small wt-bold f-color-primary">keyboard_double_arrow_right</span>
                </td>
                <td>
                    {{fieldPair.after.textRepresentation}}
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</p-dialog>

<!--Диалог для установки даты и времени актуальности задачи-->
<p-dialog [(visible)]="isShowSchedulingDialog" [dismissableMask]="true"
          [draggable]="false" [modal]="true" [resizable]="false"
          [style]="{maxHeight: '70vh'}" header="Планирование задачи">
    <ng-template pTemplate="content">
        <div class="flexed column gap10">
            <p-calendar [(ngModel)]="selectedTaskDateTime" [inline]="true" [selectOtherMonths]="true"
                        [showTime]="true"></p-calendar>
            <app-button (onClick)="setDateTimeOfTaskRelevance()" [loading]="changingTaskDateTime"
                        label="Установить"></app-button>
        </div>
    </ng-template>
</p-dialog>

<!--Диалог принудительного закрытия журнала работ-->
<p-dialog [(visible)]="forceCloseWorkLogDialogVisible" [draggable]="false" [modal]="true" [resizable]="false"
          [style]="{width: '50vw', minWidth: 'fit-content'}" [dismissableMask]="true"
          header="Принудительно закрыть журнал работ?">
    <ng-template pTemplate="content">
        <div class="flexed column gap10">
            <div class="input-label-wrapper">
                <label>Причина принудительного закрытия</label>
                <textarea [(ngModel)]="forceCloseWorkLogReason" [autoResize]="true" [rows]="5" class="stretched"
                          pInputTextarea></textarea>
            </div>
            <div class="flexed hcenter vend gap10">
                <p-button (onClick)="forceCloseWorkLogDialogVisible = false; forceCloseWorkLogReason=''"
                          [disabled]="isForceClosingWorkLog"
                          icon="mdi-close"
                          label="Отменить"
                          styleClass="p-button-secondary p-button-text"></p-button>
                <p-button (onClick)="forceCloseWorkLog()" [disabled]="!forceCloseWorkLogReason"
                          [loading]="isForceClosingWorkLog"
                          icon="mdi-check"
                          label="Закрыть" styleClass="p-button-danger"></p-button>
            </div>
        </div>
    </ng-template>
</p-dialog>

<app-work-logs-dialog #workLogsDialogEl></app-work-logs-dialog>

<p-menu #stageMenu [model]="stageMenuItems" [popup]="true" appendTo="body"></p-menu>

<p-confirmPopup key="popup"></p-confirmPopup>

<app-employee-insert-panel #empInsertPanel (onReturnFocus)="forceFocusCommentInput()"
                           (onSelect)="insertEmployeeToCommentEditor($event)"></app-employee-insert-panel>

<ng-template #actualFromLabel>
    <div [pTooltip]="(currentTask?.actualFrom | date:'dd MMMM yyyy HH:mm')??''"
         [style.color]="'#f7ce2a'" class="flexed gap3 caption hcenter p10" tooltipPosition="bottom">
        <i class="mdi-today parent-inherit"></i>
        <span>
            Запланирована через
        </span>
        <span>
            {{actualFromTime$ | async}}
        </span>
    </div>
</ng-template>

<ng-template #actualToLabel>
    <div [pTooltip]="(currentTask?.actualTo | date:'dd MMMM yyyy HH:mm')??''"
         [style.color]="'#ff512a'" class="flexed gap3 caption hcenter p10" tooltipPosition="bottom">
        <i class="mdi-today parent-inherit"></i>
        <span>
            Срок выполнения
        </span>
        <span>
            {{actualToTime$ | async}}
        </span>
    </div>
</ng-template>
